component: MEF_Center
product: MEF_Center
systemEnv:
  - workspace
  - processor
  - version
TOP_DIR: "{{systemEnv.workspace}}/{{component}}"
EDGE_MANAGER_DIR: "{{systemEnv.workspace}}/{{component}}/edge-manager"
SOFTWARE_MANAGER_DIR: "{{systemEnv.workspace}}/{{component}}/software-manager"
CERT_MANAGER_DIR: "{{systemEnv.workspace}}/{{component}}/cert-manager"
compile:
  input:
    dependency:
      - name: edge-manager
        version: "1.0"
        type: opensource
        buildFile: "{{EDGE_MANAGER_DIR}}/build/conf"
      - name: software-manager
        version: "1.0"
        type: opensource
        buildFile: "{{SOFTWARE_MANAGER_DIR}}/build/conf"
      - name: cert-manager
        version: "1.0"
        type: opensource
        buildFile: "{{CERT_MANAGER_DIR}}/build/conf"
    files:
      exclude:
        - remove: ["{{TOP_DIR}}/output/"]
        - makedir:
            path: "{{TOP_DIR}}/output"
  process:
    language: go
    compilePath:
    parameters:
  output:
    files:
      include:
        - copy:
            src:
              - '{{EDGE_MANAGER_DIR}}/output/*.zip'
            des: "{{TOP_DIR}}/output/"
        - copy:
            src:
              - '{{SOFTWARE_MANAGER_DIR}}/output/*.zip'
            des: "{{TOP_DIR}}/output/"
        - copy:
            src:
              - '{{CERT_MANAGER_DIR}}/output/*.zip'
            des: "{{TOP_DIR}}/output/"
        - mode:
            src:
              - "{{TOP_DIR}}/output/*"
            mode: "400"